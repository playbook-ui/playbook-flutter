name: workspace
description: playbook

environment:
  sdk: ^3.9.0

workspace:
  - packages/playbook
  - packages/playbook_generator
  - packages/playbook_ui
  - packages/playbook_snapshot
  - examples/generator_app
  - examples/simple_app

dev_dependencies:
  melos: ^7.0.0
  very_good_analysis: ^10.0.0

melos:
  scripts:
    format: dart run melos exec -- flutter format .

    analyze: dart run melos exec -- flutter analyze .

    clean: dart run melos exec -- flutter clean

    gen:
      run: dart run melos gen:all --no-select

    gen:all:
      run: |
        dart run melos exec -- dart run build_runner build --delete-conflicting-outputs
      packageFilters:
        dependsOn: build_runner

    test:
      run: dart run melos test:snapshot --no-select

    test:snapshot:
      run: |
        dart run melos exec -- flutter test --update-goldens
      packageFilters:
        dependsOn:
          - playbook_snapshot
        dirExists:
          - test

    test:all:
      run: |
        dart run melos exec -- flutter test --update-goldens
      packageFilters:
        dirExists:
          - test
